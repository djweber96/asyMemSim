an%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% function:    asyMemLocalSolve(sysInfoExt)                               %
% Description: Solve boundary value problem for local flux model of       %
%                asymetric membrane layer using Maxwell-Stefan (MS)       %
%                coupled transport framework in terms of volume fractions %
%                that is useful for modeling polymeric materials.         %
% Input:       sysInfo       - external struct defining simulation specs  %
%                                (memID, mixID, yf, n, lmem, Pu, Pd, T, R %
%                                memPhaseModel, diffModel, swlDiffModel)  %
%                                *see descriptions below.                 %
% Output:      localCompFlux - n+1 dimensional vector of support layer    %
%                                compositions and total local mem flux    %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

function [localCompFlux,partialFlux,exitFlag,output] = asyMemLocalSolve(sysInfo)    

%------------------------------------------------------------------------------------------------------------------------------------% 
%assign/unpack parameters
    [params] = feval(sysInfo.dataBankName,sysInfo);
    n = params.n;
    if contains(sysInfo.memPhaseModel,'DSM')||contains(sysInfo.memPhaseModel,'FH-LM')
        bs = params.bs;
        Ch = params.Ch;
    end
    psat = params.psat;
    T = params.T;
    R = params.R;
    Vs = params.Vs;
    Pu = params.Pu;
    yf = params.yf;
    if contains(sysInfo.memPhaseModel,'DSM')
        ks = params.ks;
    end
    params.purFug = psat.*exp(Vs(1:n).*(Pu-psat*0.00131)/(R*T));
    params.chisDone = 0;
    params.diffsDone = 0;
%------------------------------------------------------------------------------------------------------------------------------------% 

%------------------------------------------------------------------------------------------------------------------------------------% 
%solve for feed conditions
    if params.memPhaseModel == 1
        phiFeed_FH_IS = y2phiPhaseEq_FH(params); %FH ideal solution
        phiFeed = phiFeed_FH_IS; %can change accordingly for IS or RM
%         phiFeed = [0.000257570510088420;0.000137138161599709;0.000271012077810872;0.000178509229757867;0.000156409792349619;0.000106250797503492;0.000857539281038702;0.000232572424277679;0.000243863616380835;0.000462519716927227;0.000279336920202183;0.000119360204090442;0.000284211983658740;0.000135985284579011;0.000319321116369375;0.000292425713602425;6.84401677640254e-05;0.000216684765946303;0.000230738110355180;0.000395373199085179;0.000252316133337784;0.000342477697566631;0.000222926124057854;0.000460656178747293;0.000161867074816843;0.000144531732079880;0.000146086963797669;0.000201291908099457;0.000146511869762448;0.000261659860642306;0.000434569909249752;0.000239642969748029;0.000157682663027892;0.000259816088862928;5.48476986951899e-05;0.000193882893858753;0.000183423324977191;0.000544418035314651;0.000311251900410406;0.000173660720122519;0.000135477618694639;0.000195334574004816;0.000134203549267559;0.000126446763591464;0.000132701318066615;0.000219480218746017;0.000198922325479061;0.000478561557242275;0.000100220107584956;0.000166478076765428;0.000228072399060818;5.65767829797971e-05;0.000155262533557109;5.13088866362593e-05;0.000259024374894632;0.000138353315913419;0.000135699182784776;0.000138422007557938;0.000144902837139961;0.000200349879988841;0.000153409697081051;9.96324866866558e-05;0.000122788300180256;0.000186724753743422;0.000174040024253859;0.000101176048966765;8.34032210112118e-05;0.000104747341510545;0.000160011396825987;0.000290225961393395;0.000211779627812665;0.000240266500798700;0.000665712906700425;7.40998050242791e-05;6.63732873440740e-05;0.000448256736528123;6.11783508218029e-05;0.000207312327722783;0.000184298295873337;0.000444708239870220;0.000150433787847845;0.000247337269130667;9.87899951895728e-05;0.000129735582978903;8.21887622313620e-05;6.23648839855337e-05;9.53421010061048e-05;0.000229260274511381;0.000397618104700943;0.000150407383528544;0.000171375917169316;0.000251559621258274;9.84900834479690e-05;0.000219082910764457;0.000159917919572774;0.000167461687537846;0.000752097361276829;9.74021834329210e-05;0.000183001342562923;0.000253547174837220;0.000185921649520447;0.000170218845082747;0.000178771683204161;0.000186937326417707;0.000292480044882389;0.000343575814054015;0.000235632242724853;0.000103722104270757;0.000142157578672605;0.000138373155191616;0.000132698316639539;9.97650516246556e-05;6.46317659248311e-05;9.29706950533912e-05;0.000137644621531483;0.000237033390799706;0.000210026588058063;0.000427552621512317;0.000372574516346895;8.70384161821634e-05;0.000388610664537931;5.07511261945409e-05;0.000125823356266173;9.88467511738679e-05;0.000407814337279051;0.000128112889531788;0.000153100429109677;0.000216134383756283;0.000299738599333488;0.000124787321951230;9.43149984881015e-05;0.000243290051321049;0.000241811713098262;0.000168193244280691;0.000179585244553315;0.000289240633081833;8.89114204533445e-05;0.000432005767275585;0.000104830111860843;0.000202116120861595;0.000487790727213636;0.000133522465753986;0.000106640243033950;0.000528980472655998;0.000143611840542502;0.000139476161140118;0.000493063203370060;0.000352939074280011;0.000656338764854785;0.000112209293655174;0.000170987559765622;9.60040040359671e-05;7.92443062985065e-05;0.000441267590788471;0.000193102828280044;0.000325694149253009;0.000224443229225160;9.61482300117980e-05;0.000106445648377036;9.92657528811242e-05;9.80681073960712e-05;0.000137918486339078;0.000140760194659603;5.73779662768158e-05;0.000102531264174929;9.92001827552250e-05;0.000149592155908466;0.000229053900286535;0.000100902765955727;0.000231300578524648;0.000103031477180884;0.000206282267110574;0.000244424227416945;0.000449106083623140;0.000213420101835666;0.000309165512620688;0.000107910604783418;0.000498397664284261;9.50265940383144e-05;5.91813608117220e-05;0.000189177123464394;0.000122501317156539;0.000112875890599913;9.28016039371857e-05;0.000132444639474496;0.000405702471931281;0.000117870966236086;0.000219395940537194;0.000397009196775574;9.92404874383456e-05;0.000269831980035712;0.000256793735835194;0.000381819010247148;0.000378267634553371;0.000206714099509046;0.000476505575094424;0.000161320929749480;0.000147873276246459;0.000137062864714278;0.000297017280450632;9.53878617912266e-05;0.000341183597811165;9.11857882303894e-05;9.17405913293082e-05;5.49376124611992e-05;0.000638177486509816;0.000549180464658943;0.000187642739278213;0.000363943054532068;0.000186035730435382;0.000279436752850261;0.000129766984019919;0.000320473248034556;6.69952764211369e-05;0.000482353870881889;9.72008626300339e-05;0.000122075899029878;0.000258420114899115;0.000273664400893857;9.53603688442936e-05;5.19211265543683e-05;0.000123136011204361;0.000345330711700888;0.000126798017513942;0.000135940971175161;0.000111226712542348;0.000565520070852272;0.000134227734299363;0.000191363817054868;0.000118267250026943;0.000105194386674090;0.000128745444766090;0.000102764992208565;0.000117551320696212;0.000172511271365156;0.000257090033366731;5.76840364469559e-05;0.000192810731435625;0.000100611597284249;9.97798454615371e-05;0.000421713638600870;5.36243954360043e-05;0.000187155266716859;5.25942656467051e-05;0.000124507791045701;0.000164728672416603;0.000136855966440373;0.000225587761206867;0.000107706440409216;0.000317754100964177;0.000128560722059565;9.73957063405294e-05;0.000156931664553018;0.000130885460120565;0.000114678733045906;9.75293712963722e-05;0.000434932289022951;0.000130828959309102;0.000126262385146399;0.000513834103738009;0.000275892768238892;0.000278607738734810;0.000165580387503169;0.000174669396464888;5.52284678994222e-05;0.000127044599840270;9.03940166583521e-05;0.000170987334677160;0.000278190786786835;0.000100080857106010;0.000121537773717427;0.000159270629773199;0.000259856439716606;0.000248713192344683;0.000125872598697647;0.000762485420560921;0.000473365748041609;0.000253606922413180;0.000361252820855627;0.000109496626034350;0.000452043735823672;0.000255023303595145;9.07956757980095e-05;0.000384050532219414;0.000160223920826065;0.000201724159422867;9.79225014709358e-05;0.000147418322571601;0.000477530634928978;9.96300981305314e-05;0.000108924339677905;0.000114461280082421;6.28243084692696e-05;0.000118404737920695;0.000305380319919067;0.000309667544234058;6.10568552762797e-05;0.000107067569409415;0.000172492210991033;0.000405137144326176;0.000202440391161581;0.000159732672223769;0.000104704560226247;9.14691568579357e-05;0.000208702005790246;0.000128117173070767;6.68822848244581e-05;0.000268010245728331;0.000408886069244143;5.04684985622008e-05;0.000132160988917136;0.000357778062978171;6.60218374297077e-05;0.000211410017939445;6.67935487758754e-05;0.000102658569353001;0.000152418317117540;0.000268336970642445;0.000291749529636050;0.000142207164592317;0.000484666269907572;0.000155247455223251;0.000297407450977872;0.000501127620083402;9.69665163496596e-05;9.04455083120261e-05;0.000195143158081978;0.000137165223106355;0.000202710476717045;0.000228635238993863;0.000459452943666038;0.000582517572979018;0.000331039471829753;5.23888770158772e-05;0.000115985947354913;0.000142245519816619;0.000314587867521991;0.000127628221518178;0.000109133792660004;0.000122323493710703;0.000237230181042431;0.000122602473633727;0.000123474158965602;0.000181982931182066;7.18318054783076e-05;0.000193887705723750;8.37069135670266e-05;5.23754279249288e-05;0.000130337452404603;7.36559093298067e-05;0.000116377495451860;0.000643636623407597;0.000217548040341971;0.000194315835276561;0.000394304461574846;0.000152784328308972;0.000229370969543309;5.29017604670743e-05;0.000194772354975565;0.000142806986656663;0.000102078398039354;0.000242474479615521;0.000285745604932086;8.48461663264398e-05;0.000113760552091358;5.55001174000719e-05;0.000154545021496348;0.000220124432214825;0.000108939726182448;7.89047495356037e-05;0.000259250794961322;0.923332597803074];
    elseif params.memPhaseModel == 2
        phiFeed_DSM_IS = y2phiPhaseEq_DSM(params);
        phiFeed = phiFeed_DSM_IS; %can change accordingly for IS or RM
    elseif params.memPhaseModel == 3
        phiFeed_FH_LM_IS = y2phiPhaseEq_FH_LM(params);
        phiFeed = phiFeed_FH_LM_IS; %can change accordingly for IS or RM
    end
    fugFeed_IS = yf.*psat.*exp(Vs(1:n).*(Pu-psat*0.00131)/(R*T)); 
%     fugFeed_IS = yf; %if assuming fs = activity
    [chis,diffs] = correlationEval(phiFeed,params.diffs,params.chis,params);
    params.diffs = diffs;
    params.chis = chis;
    params.chisDone = 1;
    params.diffsDone = 0;
%------------------------------------------------------------------------------------------------------------------------------------% 

%------------------------------------------------------------------------------------------------------------------------------------% 
%Sorption model matrix initialize
    frameMatrix = ones(n,n+1)-[diag(ones(n,1)),zeros(n,1)];
    upTriChis = triu(chis(1:n,:),1);
    diagVsInv = diag(1./Vs);
    diagVs = diag(Vs(1:n));
    params.upTriChis = upTriChis;
    params.FH_VFV = (diagVs*(frameMatrix)*diagVsInv);
    params.FH_VLV = diagVs*tril(chis(1:n,:),-1)*diagVsInv;
%------------------------------------------------------------------------------------------------------------------------------------% 

%------------------------------------------------------------------------------------------------------------------------------------% 
%diffFit Initialize
    if sysInfo.diffFit == 1
        params.diffs(2) = sysInfo.diffFitIter;
    end
%------------------------------------------------------------------------------------------------------------------------------------% 

%------------------------------------------------------------------------------------------------------------------------------------%     
%solve local flux model
    if sysInfo.initGuessApprox == 1
        totalFluxGuess = 0.0; %LMH
        localCompFluxGuess = [yf;totalFluxGuess];
        localCompFluxGuess = asyMemLocalFoEu_QUICK(phiFeed,localCompFluxGuess,fugFeed_IS,params);
        localCompFluxGuess = abs(localCompFluxGuess);
    elseif sysInfo.initGuessApprox == 0 && any(sysInfo.customInitGuessApprox ~= 0)
        localCompFluxGuess = sysInfo.customInitGuessApprox;
    else
        totalFluxGuess = 0.0; %LMH
        localCompFluxGuess = [yf;totalFluxGuess];
    end
  %solve local flux model (SA, MSA, or FUD)
    if contains(sysInfo.numMethod,'NormShootAlg')
        [localCompFlux,exitFlag,output] = asyMemLocalSA(phiFeed,localCompFluxGuess,fugFeed_IS,params);
    elseif contains(sysInfo.numMethod,'FullDis')
        [localCompFlux,exitFlag,output] = asyMemLocalFUD(phiFeed,localCompFluxGuess,fugFeed_IS,params);
    elseif contains(sysInfo.numMethod,'MultShootAlg')
        [localCompFlux,exitFlag] = asyMemLocalMSA(phiFeed,localCompFluxGuess,fugFeed_IS,params);
        output = [];
    end
    if sysInfo.pervapMode == 0 && params.currentStateLit_eqnSetup == 0
        partialFlux = localCompFlux(n+1)*localCompFlux(1:n).*params.Vs(1:n)/sum(localCompFlux(1:n).*params.Vs(1:n));
    else
        partialFlux = localCompFlux;
        localCompFlux = [localCompFlux(1:n)./Vs(1:n)/sum(localCompFlux./Vs(1:n));sum(partialFlux)];
    end        
%------------------------------------------------------------------------------------------------------------------------------------% 

%------------------------------------------------------------------------------------------------------------------------------------% 
%test solve global module BVP
%    params.yf_init = params.yf;
%    flowVec = asyMemGlobalSolve(params);
%------------------------------------------------------------------------------------------------------------------------------------%    

%% ect.    
    
%ideas/notes:
    %?have sweep flow rate to make certain bulk phase comp that will be in
    %eq with permeate side? in order to have desired flux for reactor
    %etc b/c based on conc??...
    

%%data sets%%    

%    binary test parameters (Lively/Ronita's Data for single comp pemreation data)
%     test_num = 4;
%     params.mixName = strcat('singleComp(from9C_params)',num2str(test_num));
%     params.chis = [1,params.chis(params.n+1,test_num);params.chis(params.n+1,test_num),1]; %note chi_ji = chi_ij
%     params.diffs = [1,params.diffs(test_num,params.n+1);params.diffs(test_num,params.n+1),1]; %um2/s  before TIPB 0.0286E-10
%     params.n = 1;
%     params.bs = params.bs(test_num);
%     params.Ch = params.Ch(test_num);
%     params.ks = params.ks(test_num);
%     params.psat = params.psat(test_num);
%     params.Vs = [params.Vs(test_num);80400]; %cm3/mol
%     params.lmem = .2; %um
%     params.yf = [1];
%     params.Pu = 60.0*0.9823; %bar ==> atm  
 

    %ternary test parameters (Lively/Ronita's Data for toluene/TIPB/Torlon)
%     n = 2;
%     Chi_matr = [1,0.003,1.73;0.003,1,1.21;1.73,1.21,1]; %note chi_ji = chi_ij
%     V_i = [106.3;241.8;80400]; %cm3/mol
%     Diff_matr = [1,1,8.62/.638;1,1,.00525;8.62/.638,.00525,1]*1E-10; %cm2/s  before TIPB 0.0286E-10
%     lmem = .00002; %cm
%     yf = [0.9;0.1];
% %    P = 88.8231; %atm = 90 bar
%     P = 59.2154; %atm = 60 bar

    %ternary test parameters (Lively/Ronita's Data for toluene/TIPB/SBAD-1)
%     params.mixName = 'binary_oX_pX_pseudo';
%     params.HanSolParam = [18,1.4,2;18,0,0.6]; %[delD,delP,delH;...]
%     params.n = 2;
%     params.chis = [1,0.003,1.04;0.003,1,1.207;1.04,1.207,1]; %note chi_ji = chi_ij
%     params.Vs = [106.3;241.83;80400]; %cm3/mol
%     params.diffs = [1,1000000000,5.502;10000000,1,0.0047]; %um2/s  before TIPB 0.0286E-10
%     params.lmem = .2; %um
%     params.yf = [0.98;0.02];
%     params.Ch = [0.2;0.087];
%     params.bs = [0.473;1.25]*760; %mixed exp and genome
%     params.psat = [22;0.0278]/760;%atm
%     params.T = 298; %K
%     params.R = 82.05; % atm cm^3 mol^-1 K^-1
%     params.Pd = 1; % atm
%     params.Pu = 10; %atm = 60 bar
    %psuedo oX pX test
%     params.HanSolParam = [18,1.4,2;18,0,0.6];
%     params.chis = [1,0.003,1.73;0.003,1,1.73;1.73,1.73,1]; %note chi_ji = chi_ij
%     params.Vs = [106.3;106.3;80400]; %cm3/mol
%     params.diffs = [1,1,8.621;1,1,8.612*1.5]; %um2/s  before TIPB 0.0286E-10 
%     params.Ch = [0.2;0.2];
%     params.bs = [0.473;0.473]*760; %FH-LM exp
%     params.psat = [22;22]/760;

% %quaternary test parameters (Lively/Ronita's Data toluene/n-Octane/1-methylnaphthalene/SBAD-1)
%      params.mixName = 'T_NO_MN';
%     params.n = 3;
%     params.HanSolParam = [18,1.4,2;15.5,0,0;20.6,0.8,4.7]; %[delD,delP,delH;...]
%     %params.chis = [1,0.013,0.11,0.872;0.013,1,0.017,1.185;0.011,0.017,1,0.751;0.872,1.185,0.751,1]; %note chi_ji = chi_ij FH based
%     params.chis = [1,0.013,0.11,1.25;0.013,1,0.017,1.47;0.011,0.017,1,1;1.25,1.47,1,1]; %FH-DSM based
%     %params.chis = [1,0.013,0.011,.92;0.013,1,0.017,1.21;0.011,0.017,1,.68;.92,1.21,0.68,1]; %Dual mode based
%     params.Vs = [106.3;162.5;139.8;80400]; %cm3/mol
%     %params.diffs = [1,1,1,7.43;1,1,1,3.81;1,1,1,0.0275]; %um2/s FH Ficks based
%     %params.diffs = [1,1,1,6.87;1,1,1,3.34;1,1,1,0.0113;6.87,3.34,.0114,1]; %um2/s FH-LM Ficks based
%     %params.diffs = [1,1,1,37.4;1,1,1,9.05;1,1,1,.197;37.4,9.05,.197,1]; %um2/s FH MS based
%     %params.diffs = [1,10,0.02,13;10*params.Vs(1)/params.Vs(2),1,1000000,4.32;0.02*params.Vs(1)/params.Vs(3),1000000,1,.0742]; %um2/s FH-LM MS based
%     %params.diffs = [1,1,1,11;1,1,1,4.28/.59;1,1,1,.0292/.59;11,4.28/.59,0.0292/.59,1]*1E-8; %Dual mode MS based
% %       params.diffs = [1,1000000,0.07,6.25;1000000,1,...
% %           1000000,4;0.07*params.Vs(1)/params.Vs(3),1000000,1,0.073]; %um2/s FH-DSM MS based tweaked to match single comp exp (OG n-Oct 2.03,
% %    params.diffs = [1,1.5,0.04,6.45;1.5*params.Vs(1)/params.Vs(2),1,1,2.59;0.04*params.Vs(1)/params.Vs(3),1*params.Vs(2)/params.Vs(3),1,0.043;7.43,3.4,0.396,1]; %um2/s FH exp tweaked to match 20bar
%      params.diffs = [1,1,1,5.36;1,1,1,1.78;1,1,1,0.0178;7.43,3.4,0.396,1]; %um2/s FH-LM exp tweaked to match 20bar
% %     params.diffs = [1,1,1,5.16;1,1,1,1.88;1,1,1,0.012;7.43,3.4,0.396,1]; %um2/s DSM exp tweaked to match 20bar
%     %params.diffs = [1,1,1,6.63;1,1,1,5.84;1,1,1,1.22;6.626,5.84,1.26,1]*1E-11; %Polymer Genome Based (zero-activity)
%     %params.diffs = [1,1,1,2.8;1,1,1,1.29;1,1,1,0.0331;2.8,1.28,0.0331,1]*1E-8; %Polymer Genome Based (unit-activity)
%     params.lmem = .2; %um
%     params.yf = [0.794;0.167;0.039]; %Mixture 1
%     %params.yf = [0.748;0.224;0.028]; %Mixture 1 test for multicomp sorp exp
%     %params.yf = [0.531;0.363;0.106]; %Mixture 2
%     params.Pu = 29.6; %atm = 30 bar
%     %params.Pu = 14.9; %atm = 15 bar
% 
% 
% %DSM
%     %params.bs = [0.356;0.164;147];%DSM excel fit torr^-1
%     params.ks = [0.00951;0.00514;5.96]; %DSM excel fit
%     %params.Ch = [0.2;0.216;0.0612]; %DSM excel fit 
% %FH-LM
%     params.bs = [0.694;0.381;610.749]; %FH-DSM exp fit torr^-1
%     %params.bs = [1.41;1.84;192.29]*760; %FH-DSM polymer genome fit
%     params.Ch = [0.2;0.11;0.207]; %FH-DSM fit cc solv/cc system
% 
%      %FFV Diff Model
%       params.unitActPhis = [0.394;0.2415;0.5214];
%     %params.Bffv = 10*[0;1;0]; %0 if phi_i_unit_act > FFV_dry and 0.3 if "" << "" 
%     params.Bffv = 0.1*ones(3,1); %0 if phi_i_unit_act > FFV_dry and 0.3 if less than
% 
%     %params.chis = [1,0.013,0.011,.75;0.013,1,0.017,3.31;0.011,0.017,1,0.35;.75,3.31,0.35,1]; %Polymer Genome Based
%     params.psat = [22;14.8;0.0799]; %torr 
%     params.Pd = 1; %atm
%     params.T = 298; %K
%     params.R = 82.05; %atm cm^3/ mol K  

%quaternary test parameters (Lively/Ronita's Data toluene/iso-octane/iso-cetane/SBAD-1) 
%     params.mixName = 'T_IO_IC';
%     params.HanSolParam = [18,1.4,2;14.1,0,0;16.3,0,0]; %[delD,delP,delH;...]
%     params.n = 3;
% %    params.chis = [1,0.002,0.003,0.872;0.002,1,0,3.148;0.003,0,1,3.272;0.872,3.148,3.272,1]; %note chi_ji = chi_ij FH exp based
%     params.chis = [1,0.002,0.003,1.25;0.002,1,0,3.88;0.003,1,1,3.66;1.25,3.88,3.66,1]; %note chi_ji = chi_ij FH-LM exp based
%     %params.chis = [1,0.002,0.003,0.75;0.002,1,0,5.97;0.003,0,1,7.11;0.75,5.97,7.11,1]; %Polymer Genome Based
%     params.Vs = [106.3;165.1;285.6;80400]; %cm3/mol
% %     params.diffs = [1,1,1,5.19;1,1,1,3.035;1,1,1,.438]; %um2/s FH MS exp based tweaked
%     %params.diffs = [1,1000000,100000000000,13;100000,1,100000000,.812;10000000,10000000,1,.325;13,0.812,0.325,1]; %um2/s FH-LM exp based MS diffs
%     
%     %FH
% %    params.diffs = [1,1,1,6.45;1,1,1,2.335;1,1,1,0.478]; %um2/s FH exp tweaked to match 20bar
% %    params.diffs = [1,1,1,6.991;1,1,1,3.25;1,1,1,0.566]; %um2/s FH (HIGH ERROR) exp tweaked to match 20bar
% %   params.diffs = [1,1,1,5.905;1,1,1,2;1,1,1,0.39]; %um2/s FH (LOW ERROR)  exp tweaked to match 20bar
%    
%    %FH-LM
%  params.diffs = [1,2,10000,5.36;2*params.Vs(1)/params.Vs(2),1,0.01,2.852;...
%        10000*params.Vs(1)/params.Vs(3),0.01*params.Vs(2)/params.Vs(3),1,0.238]; %um2/s FH-LM exp tweaked to match 20bar
% %  params.diffs = [1,2,10000,5.815;2*params.Vs(1)/params.Vs(2),1,0.01,3.98;...
% %        10000*params.Vs(1)/params.Vs(3),0.01*params.Vs(2)/params.Vs(3),1,0.285]; %um2/s FH-LM (HIGH ERROR) exp tweaked to match 20bar
% %  params.diffs = [1,2,10000,4.906;2*params.Vs(1)/params.Vs(2),1,0.01,1.7;...
% %        10000*params.Vs(1)/params.Vs(3),0.01*params.Vs(2)/params.Vs(3),1,0.195]; %um2/s FH-LM (LOW ERROR) exp tweaked to match 20bar
%   
%    %DSM
% %  params.diffs = [1,1,1,5.18;1,1,1,3.11;1,1,1,0.202]; %um2/s DSM exp tweaked to match 20bar
% %  params.diffs = [1,1,1,5.65;1,1,1,4.345;1,1,1,0.245]; %um2/s DSM  (HIGH ERROR) exp tweaked to match 20bar
% % params.diffs = [1,1,1,4.745;1,1,1,1.835;1,1,1,0.165]; %um2/s DSM (LOW ERROR) exp tweaked to match 20bar
% 
%     %params.diffs = [1,1,1,6.87;1,1,1,2.71;1,1,1,0.114;6.87,2.71,0.114,1]; %um2/s FH exp based Ficks
% %     params.diffs = [1,100000,1,6.25...
% %         ;100000*params.Vs(1)/params.Vs(3),1,100000,6.25;1*params.Vs(1)/params.Vs(3),100000,1,6.25];  % um2/s iC 0.238 OG Tweeked to match exp FH-DSM
%     %params.diffs= [1,1,1,6.63;1,1,1,1.91;1,1,1,1.22;6.63,1.91,1.22,1]*1E-11; %Polymer Genome Based (zero-activity)
%     %params.diffs = [1,1,1,2.8;1,1,1,0.533;1,1,1,.0183;2.8,.533,0.0183,1]*1E-8; %Dual mode based%Polymer Genome Based (unit-activity)
%     params.lmem = .2; %um
%     params.yf = [0.284;0.388;0.328]; %Mixture 1 P = 30 bar
%     %params.yf = [.282;0.385;0.333]; %Mixture 2 P = 60 bar
%     params.Pd = 1; %atm
% %      params.Pu = 30*0.9823; %atm = 30 bar
%    params.Pu = 60*0.9823; %atm = 60 bar
%     
%     %FH-LM
%     params.bs = [0.694;0.158;249.039]; %torr^-1
%     params.Ch = [0.2;0.0099;0.00677]; %cc solv/cc system
%     
%     %DSM
% %     params.bs = [0.356;0.154;721]; %torr^-1
% %     params.Ch = [0.2;0.00949;0.00310]; %cc solv/cc system
%     params.ks = [0.00951;0.000170;0.972]; 
% 
%      %FFV Diff Model
%       params.unitActPhis = [0.394;0.0169;0.0160];
% %     params.Bffv = 0.03*[0;1;1]; %0 if phi_i_unit_act > FFV_dry and 0.3 if "" << "" 
% %     params.Bffv = [0;0.1005;0.116]; %0 if phi_i_unit_act > FFV_dry and 0.3 if "" << "" 
%       params.Bffv = 0.6*ones(3,1); %0 if phi_i_unit_act > FFV_dry and 0.3 if less than
%     
%     params.psat = [22;49.1;0.0131]; %torr 0.000383 atm, from H_vap = 45.8kj/mol 0.000138 atm was CC estimate w/ hvap = 52000j/mol, 0.0000183 atm from ASPEN, 0.000017237 atm was Yaws handbook w/ extrapolated antiones
%     params.T = 298; %K
%     params.R = 82.05; %cm^3 atm/mol K 

% %quaternary test parameters (Lively/Ronita's Data toluene/n-Octane/iso-Cetane/SBAD-1)
%     params.mixName = 'T_NO_IC';
%     params.n = 3;
%     params.HanSolParam = [18,1.4,2;15.5,0,0;16.3,0,0]; %[delD,delP,delH;...]
%     params.chis = [1,0.0013,0.0011,1.25;0.0013,1,0.0017,1.47;0.0011,0.0017,1,3.66;1.25,1.47,3.66,1]; %FH-DSM based
%     params.Vs = [106.3;162.5;285.56;80400]; %cm3/mol
%     params.diffs = [1,1000000,1000000,6.25;1000000,1,...
%         1000000,2.03;1000000,1000000,1,0.238]; % iso-cetane 0.238 %FH-DSM MS based tweaked to match single comp exp
%     params.lmem = .2; %um
%     params.yf = [0.976;0.01514;0.00856]; %Dilute except Tol
%     %params.yf = [0.04013;0.95;0.00987]; %Dilute except nOCT
%     params.Pu = 29.6; %atm = 30 bar
%     params.bs = [0.694;0.381;249.039]; %FH-DSM exp fit torr^-1
%     params.Ch = [0.2;0.11;0.00677]; %FH-DSM fit cc solv/cc system
%     params.psat = [22;14.8;0.0131]; %torr 
%     params.Pd = 1; %atm
%     params.T = 298; %K
%     params.R = 82.05; %atm cm^3/ mol K

    %quaternary test parameters (Lively/Ronita's Data with average properties psuedocomponent added)
%     n = 3;
%     Chi_matr = [1,0.003,0.05,1.73;0.003,1,0.08,0.01;0.05,0.08,1,0.1;1.73,0.01,0.1,1]; %note chi_ji = chi_ij
%     V_i = [106.3;241.8;150;80400]; %cm3/mol
%     Diff_matr = [1,1,1,8.62;1,1,1,.0286;1,1,1,0.5;8.62,.0286,0.5,1]; %um2/s
%     lmem = .00004; %cm
%     yf = [0.9;0.05;0.05];
%     %P = 88.8231; %atm = 90 bar
%     P = 59.2154; %atm = 60 bar

    %quinary test parameters (Lively/Ronita's Data with averaged properties psuedocomponent added
%     n = 4;
%     Chi_matr = [1,0.003,0.05,1.12,1.73;0.003,1,0.08,0.02,0.01;0.05,0.08,1,0.92,0.1;1.12,0.02,0.92,1,0.06;1.73,0.01,0.1,0.06,1]; %note chi_ji = chi_ij
%     V_i = [106.3;241.8;150;340;80400]; %cm3/mol
%     Diff_matr = [1,1,1,1,8.62;1,1,1,1,.0286;1,1,1,1,0.5;1,1,1,1,0.12;8.62,.0286,0.5,0.12,1]*1E-10; %cm2/s
%     lmem = .00004; %cm
%     yf = [0.8;0.05;0.05;0.1];
%     %P = 88.8231; %atm = 90 bar
%     P = 59.2154; %atm = 60 bar

    %senary test parameters (Raisi's Test Data - Except its for Pervaporation)
%     n = 5;
%     Chi_matr = [1,0.003,0.05,1.12,0.001,4.6672;0.003,1,0.08,0.02,0.2,1.0298;0.05,0.08,1,0.92,1,0.9447;1.12,0.02,0.92,1,1.4,1.2433;0.001,0.2,0.92,1.4,1,1.7493;4.6672,1.2433,0.9447,1.2433,1.7493,1]; %note chi_ji = chi_ij
%     V_i = [106.3;241.8;150;340;150;80400]; %cm3/mol
%     Diff_matr = [1,1,1,1,1,2000;1,1,1,1,1,1.41;1,1,1,1,1,3.62;1,1,1,1,1,1.81;1,1,1,1,1,8.17;2000,1.41,3.62,1.81,8.17,1]; %um2/s    
%     lmem = .001; %cm    
%     yf = [0.999938;0.00002;0.000014;0.000018;0.00001];
%     %P = 88.8231; %atm = 90 bar
%     P = 29.2154; %atm = 60 bar
    
%  senary test parameters (Lively/Ronita's Exp Data for 5-comp TOL/1MN/NOC/IOC/ICE/SBAD-1)
%    params.mixName = 'T_MN_NO_IO_IC';
%    params.n = 5;
% %    params.chis = [1,0.0003,0.0005,1.04,0.0001,0.78;0.0003,1,0.0008,0.0002,0.002,0.661;0.0005,...
% %        0.0008,1,0.0006,1,1.117;0.0003,0.0002,0.0004,0.0004,0.0002,3.389;0.0002,0.001,0.0002,0.0001,...
% %        0.002,3.194;0.78,0.661,1.117,3.389,3.194,1]; %note chi_ji = chi_ij FH EXP
%    params.chis = [1,0.0003,0.0005,0.0001,0.0001,1.25;0.0003,1,0.0008,0.0002,0.002,1;0.0005,...
%        0.0008,1,0.0006,1,1.47;0.0003,0.0002,0.0004,0.0004,0.0002,3.88;0.0002,0.001,0.0002,0.0001,...
%         0.002,3.66;1.25,1,1.47,3.88,3.66,1]; %note chi_ji = chi_ij FH_DSM EXP
%    params.Vs = [106.3;142.2;163.42;165.55;285.56;80400]; %cm3/mol
%    params.HanSolParam = [18,1.4,2;20.6,0.8,4.7;15.5,0,0;14.1,0,0;16.3,0,0]; %[delD,delP,delH;...]
% %   params.diffs = [1,1,1,1,1,37.4;1,1,1,1,1,0.197;1,1,1,1,1,9.05;...
% %       1,1,1,1,1,3.54;1,1,1,1,1,.454;37.4,0.197,9.05,3.542,0.454,1]; %um2/s FH EXP
%     params.diffs = [1,0.07,0.05,0.05,0.015,6.25;0.07*params.Vs(1)/params.Vs(2),1,100000,100000,100000,0.022;0.05*params.Vs(1)/params.Vs(4),100000,1,100000,100000,2.03;...
%         0.05*params.Vs(1)/params.Vs(4),100000,100000,1,100000,2.852;0.015*params.Vs(1)/params.Vs(5),100000,100000,100000,1,0.238]; %um2/s FH_DSM EXP (tweaked)
% %     params.diffs = [1,100000,100000,100000,100000,13;100000,1,100000,100000,100000,0.073;100000,100000,1,100000,100000,4.32;...
% %         100000,100000,100000,1,100000,0.812;100000,100000,100000,100000,1,0.326]; %um2/s FH_DSM EXP 
%    params.lmem = .2; %um
%    params.Ch = [0.2;0.207;0.11;0.0099;0.00677];
%    params.bs = [0.694;610.749;0.381;0.158;249.039]; %FH-LM exp
%    params.psat = [22;0.0799;14.8;49.1;0.0141];
%    params.T = 298; %K
%    params.R = 82.05; % atm cm^3 mol^-1 K^-1
%    params.yf = [0.24;0.0239;0.453;0.266;0.017];
%    %params.yf = [0.9319;0.00213;0.0361;0.0198;0.0101]; %Dilute mixture(mainly TOL)
%    %params.yf = [0.0391;0.000570;0.944;0.00613;0.00971]; %Dilute mixture(mainly NOC)
%    %params.Pu = 59.214; %atm = 60 bar
%    %params.Pu = 49.3462; %atm = 50 bar
%    params.Pu = 29.2154; %atm = 30 bar
%    params.Pd = 1; % atm 
   
   %Lively/Ronita's Exp Data for 5-comp TOL/HEP/PXY/OXY/ICE/PIM-1
%    params.mixName = 'T_HP_PX_OX_IC_PIM1';
%    params.n = 5;
% %    params.chis = [1,0.0003,0.0005,1.04,0.0001,0.692;0.0003,1,0.0008,0.0002,0.002,0.959;0.0005,...
% %        0.0008,1,0.0006,1,.685;0.0003,0.0002,0.0004,0.0004,0.0002,0.578;0.0002,0.001,0.0002,0.0001,...
% %        0.002,1.23;0.692,0.959,0.685,0.578,1.23,1]; %note chi_ji = chi_ij FH EXP
%     params.chis = [1,0.0003,0.0005,0.0001,0.0001,1.08;0.0003,1,0.0008,0.0002,0.002,1.92;0.0005,...
%        0.0008,1,0.0006,1,1.11;0.0003,0.0002,0.0004,0.0004,0.0002,0.77;0.0002,0.001,0.0002,0.0001,...
%         0.002,2.1;1.08,1.92,1.11,0.77,2.1,1]; %note chi_ji = chi_ij FH_DSM EXP
%     params.Vs = [106.3;146.9;123.7;121.19;285.56;80400]; %cm3/mol
%     params.HanSolParam = [18,1.4,2;15.3,0,0;17.6,1,3.1;17.8,1,3.1;16.3,0,0]; %[delD,delP,delH;...]
%     
% %     params.diffs = [1,100000,100000,100000,100000,1.33;...
% %         100000,1,100000,100000,100000,4.51;...
% %         100000,100000,1,100000,100000,0.888;...
% %         100000,100000,100000,1,100000,0.645;...
% %         100000,100000,100000,100000,1,0.0664]; %um2/s "thermo corrected diff"
% 
%     %FH-LM
%     params.diffs = [1,100000,100000,100000,100000,2.9;...
%         100000,1,100000,100000,100000,14.58;...
%         100000,100000,1,100000,100000,1.895;...
%         100000,100000,100000,1,100000,0.744;...
%         100000,100000,100000,100000,1,0.4]; %um2/s FH_DSM EXP (tweaked @20 bar)
% %     params.diffs = [1,100000,100000,100000,100000,3.645;...
% %         100000,1,100000,100000,100000,17.3;...
% %         100000,100000,1,100000,100000,2.37;...
% %         100000,100000,100000,1,100000,0.88;...
% %         100000,100000,100000,100000,1,0.575]; %um2/s FH_DSM (HIGH ERROR) EXP (tweaked @20 bar)
% %     params.diffs = [1,100000,100000,100000,100000,2.155;...
% %         100000,1,100000,100000,100000,11.85;...
% %         100000,100000,1,100000,100000,1.425;...
% %         100000,100000,100000,1,100000,0.607;...
% %         100000,100000,100000,100000,1,0.22]; %um2/s FH_DSM EXP (LOW ERROR) (tweaked @20 bar)
%     
%     %DSM
% %     params.diffs = [1,100000,100000,100000,100000,2.889;...
% %         100000,1,100000,100000,100000,13.95;...
% %         100000,100000,1,100000,100000,1.74;...
% %         100000,100000,100000,1,100000,0.644;...
% %         100000,100000,100000,100000,1,0.36]; %um2/s DSM EXP  (tweaked @20 bar)
% %     params.diffs = [1,100000,100000,100000,100000,3.63;...
% %         100000,1,100000,100000,100000,16.57;...
% %         100000,100000,1,100000,100000,2.178;...
% %         100000,100000,100000,1,100000,0.762;...
% %         100000,100000,100000,100000,1,0.518]; %um2/s DSM EXP (HIGH ERROR)(tweaked @20 bar)
% %     params.diffs = [1,100000,100000,100000,100000,2.145;...
% %         100000,1,100000,100000,100000,11.34;...
% %         100000,100000,1,100000,100000,1.31;...
% %         100000,100000,100000,1,100000,0.525;...
% %         100000,100000,100000,100000,1,0.197]; %um2/s DSM EXP (LOW ERROR)(tweaked @20 bar)
% 
%     %FH
% %     params.diffs = [1,100000,100000,100000,100000,4.755;...
% %         100000,1,100000,100000,100000,16.2;...
% %         100000,100000,1,100000,100000,4.27;...
% %         100000,100000,100000,1,100000,1.985;...
% %         100000,100000,100000,100000,1,1.16]; %um2/s FH EXP (tweaked @20 bar)
% %     params.diffs = [1,100000,100000,100000,100000,5.98;...
% %         100000,1,100000,100000,100000,19.28;...
% %         100000,100000,1,100000,100000,5.345;...
% %         100000,100000,100000,1,100000,2.35;...
% %         100000,100000,100000,100000,1,1.68]; %um2/s FH EXP (HIGH ERROR)(tweaked @20 bar)
% %     params.diffs = [1,100000,100000,100000,100000,3.535;...
% %         100000,1,100000,100000,100000,13.185;...
% %         100000,100000,1,100000,100000,3.207;...
% %         100000,100000,100000,1,100000,1.62;...
% %         100000,100000,100000,100000,1,0.64]; %um2/s FH EXP (LOW ERROR)(tweaked @20 bar)
% 
%     params.lmem = .2; %um
%     %FH-LM exp
%    params.Ch = [0.33;0.26;0.35;0.3;0.18];
%    params.bs = [1.515;1.492;5.57;22.357;3378.468];
%     %DSM params
% %     params.Ch = [0.227;0.259;0.254;0.214;0.169];
% %     params.bs = [8.36;1.63;509.75;196790.38;4128]; %torr^-1 mixed exp and genome
%     params.ks = [0.0158;0.00267;0.0366;0.0695;5.659]; 
%    
%   %FFV Diff Model
%       params.unitActPhis = [0.595;0.333;0.604;0.8045;0.239];
%     params.Bffv = 0.1*[0;0;0;0;1]; %0 if phi_i_unit_act > FFV_dry and 0.3 if "" << "" 
%    %  params.Bffv = 0.1*ones(5,1); %0 if phi_i_unit_act > FFV_dry and 0.3 if less than
%     
%     params.psat = [22;35;9;7;0.0131];
%     params.T = 298; %K
%     params.R = 82.05; % atm cm^3 mol^-1 K^-1
%     params.yf = [0.251;0.227;0.202;0.261;0.058]; %mixture simulation
%    % params.yf = [0.406;0.000001;0.401;0.000001;0.193]; %multicomp sorption
%     %params.Pu = 59.214; %atm = 60 bar
%     %params.Pu = 49.3462; %atm = 50 bar
%     params.Pu = 29.2154; %atm = 30 bar
%     params.Pd = 1; % atm

    %septary test parameters (Lively/Ronita's Data with averaged properties psuedocomponent added
%     n = 6;
%     Chi_matr = [1,0.003,0.05,1.12,0.001,2.5,1.73;0.003,1,0.08,0.02,0.2,0.25,0.01;0.05,0.08,1,0.92,1,0.75,...
%         0.1;1.12,0.02,0.92,1,1.4,0.001,0.06;0.001,0.2,0.92,1.4,1,1.4,0.001;...
%         2.5,0.25,0.75,0.001,1.4,1,0.69;1.73,0.01,0.1,0.06,0.001,0.69,1]; %note chi_ji = chi_ij
%     V_i = [106.3;241.8;150;340;150;249;80400]; %cm3/mol
%     Diff_matr = [1,1,1,1,1,1,8.62;1,1,1,1,1,1,.0286;1,1,1,1,1,1,0.5;1,1,1,1,1,1,0.12;1,1,1,1,1,1,3.62;1,1,1,1,1,1,0.006;8.62,.0286,0.5,0.12,3.62,0.006,1]*1E-10; %cm2/s
%     lmem = .00004; %cm
%     yf = [0.8;0.05;0.05;0.05;0.025;0.025];
%     %P = 88.8231; %atm = 90 bar
%     P = 29.2154; %atm = 60 bar
    
    %octary test parameters (Lively/Ronita's Data with averaged properties psuedocomponent added
%     n = 7;
%     Chi_matr = [1,0.003,0.05,1.12,0.001,2.5,0.1,1.73;0.003,1,0.08,0.02,0.2,0.25,1.2,0.01;0.05,0.08,1,0.92,1,0.75,1.65...
%         0.1;1.12,0.02,0.92,1,1.4,.006,0.001,0.06;0.001,0.2,0.92,1.4,1,1.4,3.2,0.001;...
%         2.5,0.25,0.75,0.001,1.4,1,1.6,0.69;1.12,1.2,1.65,.001,3.2,1.6,1,3.4;1.73,0.01,0.1,0.06,0.001,0.69,3.4,1]; %note chi_ji = chi_ij
%     V_i = [106.3;241.8;150;340;150;249;56;80400]; %cm3/mol
%     Diff_matr = [1,1,1,1,1,1,1,8.62;1,1,1,1,1,1,1,.0286;1,1,1,1,1,1,1,0.5;...
%         1,1,1,1,1,1,1,0.12;1,1,1,1,1,1,1,3.62;1,1,1,1,1,1,1,0.006;...
%         ;1,1,1,1,1,1,1,10.4;8.62,.0286,0.5,0.12,3.62,0.006,10.4,1]*1E-10; %cm2/s
%     lmem = .00004; %cm
%     yf = [0.85;0.05;0.025;0.025;0.025;0.0125;0.0125];
%     %P = 88.8231; %atm = 90 bar
%     P = 29.2154; %atm = 60 bar
    
    %nonary test parameters (Lively/Ronita's Data with averaged properties psuedocomponent added
%     n = 8;
%     Chi_matr = [1,0.003,0.05,1.12,0.001,2.5,0.1,2.1,1.73;0.003,1,0.08,0.02,0.2,1.2,0.25,1.2,0.01;0.05,0.08,1,0.92,1,0.75,1.65...
%         ,2.1,0.1;1.12,0.02,0.92,1,1.4,.006,0.001,1.2,0.06;0.001,0.2,0.92,1.4,1,1.4,3.2,2.1,0.001;...
%         2.5,0.25,0.75,0.001,1.4,1,1.6,1.2,0.69;1.12,1.2,1.65,.001,3.2,1.6,1,2.1,3.4;2.1,1.2,2.1,1.2,2.1,1.2,2.1,1,1.2;...
%         1.73,0.01,0.1,0.06,0.001,0.69,3.4,1.2,1]; %note chi_ji = chi_ij
%     V_i = [106.3;241.8;150;340;150;249;56;125;80400]; %cm3/mol
%     Diff_matr = [1,1,1,1,1,1,1,1,8.62;1,1,1,1,1,1,1,1,.0286;1,1,1,1,1,1,1,1,0.5;...
%         1,1,1,1,1,1,1,1,0.12;1,1,1,1,1,1,1,1,3.62;1,1,1,1,1,1,1,1,0.006;...
%         1,1,1,1,1,1,1,1,10.4;1,1,1,1,1,1,1,1,0.25;8.62,.0286,0.5,0.12,3.62,0.006,10.4,0.25,1]*1E-10; %cm2/s
%     lmem = .00004; %cm
%     yf = [0.75;0.05;0.025;0.0125;0.0125;0.0125;0.0125;0.125];
%     %P = 88.8231; %atm = 90 bar
%     P = 29.2154; %atm = 60 bar

 

      %denary test parameters (Lively / Ronita's 9-comp sep TOL/MCH/1MN/DCN/NOC/IOC/TBB/TPB/ICE/SBAD-1)
%      params.mixName = 'T_MC_MN_DC_NO_IO_TB_TP_IC_SBAD';
%     params.n = 9; 
%     params.Vs = [106.3;127.5;142.2;154.3;163.42;165.55;154.81;241.83;285.56;80400]; %cm3/mol
%     params.HanSolParam = [18,1.4,2;16,0,1;20.6,0.8,4.7;18,0,0;15.5,0,0;14.1,0,0;17.4,0.1,1.1;18,0,0.6;16.3,0,0]; %[delD,delP,delH;...]
%     
%     %FH
%     params.chis = [1,1,1,1,1,1,1,1,1,0.872;...
%                 1,1,1,1,1,1,1,1,1,1.735;...
%                 1,1,1,1,1,1,1,1,1,0.751;...
%                 1,1,1,1,1,1,1,1,1,2.898;...
%                 1,1,1,1,1,1,1,1,1,1.185;...
%                 1,1,1,1,1,1,1,1,1,3.148;...
%                 1,1,1,1,1,1,1,1,1,2.442;...
%                 1,1,1,1,1,1,1,1,1,2.783;...
%                 1,1,1,1,1,1,1,1,1,3.272];
%                 params.chis(params.n+1,1:params.n+1) =  [params.chis(:,end).',1]; %note chi_ji = chi_ij exp FH
% %      params.diffs = [1,1,1,1,1,1,1,1,1,37.4;...
% %                  1,1,1,1,1,1,1,1,1,13.8;...
% %                  1,1,1,1,1,1,1,1,1,0.197;...
% %                  1,1,1,1,1,1,1,1,1,3.73;...
% %                  1,1,1,1,1,1,1,1,1,9.05;...
% %                  1,1,1,1,1,1,1,1,1,3.54;...
% %                  1,1,1,1,1,1,1,1,1,6.66;...
% %                  1,1,1,1,1,1,1,1,1,0.0114;...
% %                  1,1,1,1,1,1,1,1,1,0.454];
% %                 params.diffs(params.n+1,1:params.n+1) =  [params.diffs(:,end).',1]; %um2/s FH Exp Based MS diffs 
% %      params.diffs = [1,100000,0.001*params.Vs(3)/params.Vs(1),1100000,1100000,1100000,1100000,1100000,1100000,6.45;...
% %                  1000000,1,1000000,1100000,1100000,1100000,1100000,1100000,1100000,1.45;...
% %                  0.001,100000,1,1100000,1100000,1100000,1100000,1100000,1100000,0.043;...
% %                  100000,100000,100000,1,1100000,1100000,1100000,1100000,1100000,1.3;...
% %                  100000,100000,100000,1100000,1,1100000,1100000,1100000,1100000,2.59;...
% %                  100000,100000,100000,1100000,1100000,1,1100000,1100000,1100000,2.335;...
% %                  100000,100000,100000,1100000,1100000,1100000,1,1100000,1100000,2.6;...
% %                  100000,100000,100000,1100000,1100000,1100000,1100000,1,1100000,0.0685;...
% %                  100000,100000,100000,1100000,1100000,1100000,1100000,1100000,1,0.478];
% %                  params.diffs(params.n+1,1:params.n+1) =  [params.diffs(:,end).',1]; %um2/s FH Exp Based tweaked for single comp MS diffs 
%    params.diffs = [1,1,1,1,1,1,1,1,1,6.991;...
%                  1,1,1,1,1,1,1,1,1,2.1465;...
%                  1,1,1,1,1,1,1,1,1,0.0605;...
%                  1,1,1,1,1,1,1,1,1,1.914;...
%                  1,1,1,1,1,1,1,1,1,3.16;...
%                  1,1,1,1,1,1,1,1,1,3.25;...
%                  1,1,1,1,1,1,1,1,1,3.34;...
%                  1,1,1,1,1,1,1,1,1,0.0685;...
%                  1,1,1,1,1,1,1,1,1,0.566];
%                 params.diffs(params.n+1,1:params.n+1) =  [params.diffs(:,end).',1];%Mixed Exp (HIGH ERROR) Based FH Tweaked to match single comp FH um2/s    
% %          params.diffs = [1,1,1,1,1,1,1,1,1,5.905;...
% %                  1,1,1,1,1,1,1,1,1,0.755;...
% %                  1,1,1,1,1,1,1,1,1,0.025;...
% %                  1,1,1,1,1,1,1,1,1,0.665;...
% %                  1,1,1,1,1,1,1,1,1,2;...
% %                  1,1,1,1,1,1,1,1,1,1.4;...
% %                  1,1,1,1,1,1,1,1,1,1.75;...
% %                  1,1,1,1,1,1,1,1,1,0.0685;...
% %                  1,1,1,1,1,1,1,1,1,0.39];
% %                 params.diffs(params.n+1,1:params.n+1) =  [params.diffs(:,end).',1];%Mixed Exp (LOW ERROR) Based FH Tweaked to match single comp FH um2/s   
% 
%     %FH-LM
%     params.chis = [1,1,1,1,1,1,1,1,1,1.25;...
%                 1,1,1,1,1,1,1,1,1,2.48;...
%                 1,1,1,1,1,1,1,1,1,1;...
%                 1,1,1,1,1,1,1,1,1,3.19;...
%                 1,1,1,1,1,1,1,1,1,1.47;...
%                 1,1,1,1,1,1,1,1,1,3.88;...
%                 1,1,1,1,1,1,1,1,1,2.8;...
%                 1,1,1,1,1,1,1,1,1,3.45;...
%                 1,1,1,1,1,1,1,1,1,3.66];
%         params.chis(params.n+1,1:params.n+1) =  [params.chis(:,end).',1]; %note chi_ji = chi_ij exp FH-LM mixed FH
% %     params.diffs = [1,1,1,1,1,1,1,1,1,13;...
% %                  1,1,1,1,1,1,1,1,1,2.71;...
% %                  1,1,1,1,1,1,1,1,1,0.073;...
% %                  1,1,1,1,1,1,1,1,1,2.54;...
% %                  1,1,1,1,1,1,1,1,1,4.32;...
% %                  1,1,1,1,1,1,1,1,1,.812;...
% %                  1,1,1,1,1,1,1,1,1,.0309;...
% %                  1,1,1,1,1,1,1,1,1,0.00527;...
% %                  1,1,1,1,1,1,1,1,1,0.36515];
% %                   params.diffs(params.n+1,1:params.n+1) = [params.diffs(:,end).',1]; %um2/s Mixed Exp Based FH-LM
% %          params.diffs = [1,1,1,1,1,1,1,1,1,5.36;...
% %                  1,1,1,1,1,1,1,1,1,2.06;...
% %                  1,1,1,1,1,1,1,1,1,0.0178;...
% %                  1,1,1,1,1,1,1,1,1,0.755;...
% %                  1,1,1,1,1,1,1,1,1,1.88;...
% %                  1,1,1,1,1,1,1,1,1,2.852;...
% %                  1,1,1,1,1,1,1,1,1,1.5;...
% %                  1,1,1,1,1,1,1,1,1,0.038;...
% %                  1,1,1,1,1,1,1,1,1,0.238];
% %                 params.diffs(params.n+1,1:params.n+1) =  [params.diffs(:,end).',1];%Mixed Exp Based FHLM Tweaked to match single comp FH-DSM um2/s    
% %          params.diffs = [1,1,1,1,1,1,1,1,1,5.815;...
% %                  1,1,1,1,1,1,1,1,1,3.07;...
% %                  1,1,1,1,1,1,1,1,1,0.0253;...
% %                  1,1,1,1,1,1,1,1,1,1.117;...
% %                  1,1,1,1,1,1,1,1,1,2.295;...
% %                  1,1,1,1,1,1,1,1,1,3.97;...
% %                  1,1,1,1,1,1,1,1,1,1.96;...
% %                  1,1,1,1,1,1,1,1,1,0.038;...
% %                  1,1,1,1,1,1,1,1,1,0.285];
% %                 params.diffs(params.n+1,1:params.n+1) =  [params.diffs(:,end).',1];%Mixed Exp (HIGH ERROR) Based FHLM Tweaked to match single comp FH-DSM um2/s    
%          params.diffs = [1,1,1,1,1,1,1,1,1,4.906;...
%                  1,1,1,1,1,1,1,1,1,1.06;...
%                  1,1,1,1,1,1,1,1,1,0.0104;...
%                  1,1,1,1,1,1,1,1,1,0.39;...
%                  1,1,1,1,1,1,1,1,1,1.455;...
%                  1,1,1,1,1,1,1,1,1,1.7;...
%                  1,1,1,1,1,1,1,1,1,1.045;...
%                  1,1,1,1,1,1,1,1,1,0.038;...
%                  1,1,1,1,1,1,1,1,1,0.195];
%                 params.diffs(params.n+1,1:params.n+1) =  [params.diffs(:,end).',1];%Mixed Exp (LOW ERROR) Based FHLM Tweaked to match single comp FH-DSM um2/s   
% %         params.diffs = [1,0.3,0.3,100000,0.1,100000,100000,0.05,100000,5.36;...
% %                  0.3*params.Vs(1)/params.Vs(2),100000,100000,100000,100000,100000,100000,100000,100000,2.06;...
% %                  0.05*params.Vs(1)/params.Vs(3),100000,100000,100000,100000,100000,100000,100000,100000,0.0178;...
% %                  100000,100000,100000,100000,100000,100000,100000,100000,100000,0.755;...
% %                  0.1*params.Vs(1)/params.Vs(5),100000,100000,100000,100000,100000,100000,100000,0.1,1.88;...
% %                  100000,100000,100000,100000,100000,100000,100000,100000,100000,2.852;...
% %                  100000,100000,100000,100000,100000,100000,100000,100000,100000,1.5;...
% %                  0.05*params.Vs(1)/params.Vs(8),100000,100000,100000,100000,100000,100000,100000,100000,0.038;...
% %                  100000,100000,100000,100000,0.1*params.Vs(5)/params.Vs(9),100000,100000,100000,100000,0.238];%fudge diff matrix (FH-LM) plus FFV diffs 
% %         params.diffs = [1,1,1,1,1,1,1,1,1,6.25;...
% %                  1,1,1,1,1,1,1,1,1,3.5;...
% %                  1,1,1,1,1,1,1,1,1,0.022;...
% %                  1,1,1,1,1,1,1,1,1,0.718;...
% %                  1,1,1,1,1,1,1,1,1,2.03;...
% %                  1,1,1,1,1,1,1,1,1,2.852;...
% %                  1,1,1,1,1,1,1,1,1,0.522;...
% %                  1,1,1,1,1,1,1,1,1,0.0048;...
% %                  1,1,1,1,1,1,1,1,1,0.238];
% %                 params.diffs(params.n+1,1:params.n+1) =  [params.diffs(:,end).',1];%Mixed Exp Based FHLM (phi_FH)*(1-Ch)Tweaked to match single comp FH-DSM  backup1.22 i-OCT for 20 bar fit but 2.852 for fit of 30bar-60bar %um2/s             
% %         params.diffs = [1,0.3,100000,100000,0.1,100000,100000,0.05,100000,2.3;...
% %                  0.3*params.Vs(1)/params.Vs(2),100000,100000,100000,100000,100000,100000,100000,100000,2.3;...
% %                  100000,100000,100000,100000,100000,100000,100000,100000,100000,2.3;...
% %                  100000,100000,100000,100000,100000,100000,100000,100000,100000,2.3;...
% %                  0.1*params.Vs(1)/params.Vs(5),100000,100000,100000,100000,100000,100000,100000,100000,2.3;...
% %                  100000,100000,100000,100000,100000,100000,100000,100000,100000,2.3;...
% %                  100000,100000,100000,100000,100000,100000,100000,100000,100000,2.3;...
% %                  0.05*params.Vs(1)/params.Vs(8),100000,100000,100000,100000,100000,100000,100000,100000,2.3;...
% %                  100000,100000,100000,100000,100000,100000,100000,100000,100000,2.3];%fudge diff matrix (FH-LM)
% 
%     %DSM
% %         params.diffs = [1,1,1,1,1,1,1,1,1,5.18;...
% %                  1,1,1,1,1,1,1,1,1,2.18;...
% %                  1,1,1,1,1,1,1,1,1,0.012;...
% %                  1,1,1,1,1,1,1,1,1,0.63;...
% %                  1,1,1,1,1,1,1,1,1,1.78;...
% %                  1,1,1,1,1,1,1,1,1,3.11;...
% %                  1,1,1,1,1,1,1,1,1,1.3;...
% %                  1,1,1,1,1,1,1,1,1,0.038;...
% %                  1,1,1,1,1,1,1,1,1,0.202];
% %                 params.diffs(params.n+1,1:params.n+1) =  [params.diffs(:,end).',1];%Mixed Exp Based DSM Tweaked to match single comp backup1.22 i-OCT for 20 bar fit but 2.852 for fit of 30bar-60bar %um2/s            
% %      params.diffs = [1,1,1,1,1,1,1,1,1,5.65;...
% %                  1,1,1,1,1,1,1,1,1,3.25;...
% %                  1,1,1,1,1,1,1,1,1,0.0172;...
% %                  1,1,1,1,1,1,1,1,1,0.931;...
% %                  1,1,1,1,1,1,1,1,1,2.1785;...
% %                  1,1,1,1,1,1,1,1,1,4.345;...
% %                  1,1,1,1,1,1,1,1,1,1.731;...
% %                  1,1,1,1,1,1,1,1,1,0.038;...
% %                  1,1,1,1,1,1,1,1,1,0.245];
% %                 params.diffs(params.n+1,1:params.n+1) =  [params.diffs(:,end).',1];%Mixed Exp (HIGH ERROR) Based DSM Tweaked to match single comp DSM um2/s    
% %          params.diffs = [1,1,1,1,1,1,1,1,1,4.745;...
% %                  1,1,1,1,1,1,1,1,1,1.121;...
% %                  1,1,1,1,1,1,1,1,1,0.00705;...
% %                  1,1,1,1,1,1,1,1,1,0.325;...
% %                  1,1,1,1,1,1,1,1,1,1.381;...
% %                  1,1,1,1,1,1,1,1,1,1.835;...
% %                  1,1,1,1,1,1,1,1,1,0.91;...
% %                  1,1,1,1,1,1,1,1,1,0.038;...
% %                  1,1,1,1,1,1,1,1,1,0.165];
% %                 params.diffs(params.n+1,1:params.n+1) =  [params.diffs(:,end).',1];%Mixed Exp (LOW ERROR) Based DSM Tweaked to match single comp DSM um2/s   
% 
%     %Polymer Genome Based
% %      params.chis = [1,1,1,1,1,1,1,1,1,0.75;...
% %                 1,1,1,1,1,1,1,1,1,2.35;...
% %                 1,1,1,1,1,1,1,1,1,0.35;...
% %                 1,1,1,1,1,1,1,1,1,1.68;...
% %                 1,1,1,1,1,1,1,1,1,3.31;...
% %                 1,1,1,1,1,1,1,1,1,5.97;...
% %                 1,1,1,1,1,1,1,1,1,1.67;...
% %                 1,1,1,1,1,1,1,1,1,7.34;...
% %                 1,1,1,1,1,1,1,1,1,7.11];
% %       params.chis(params.n+1,1:params.n+1) =  [params.chis(:,end).',1];%note chi_ji = chi_ij Polymer Genome Based
% %     params.diffs = [1,100000,100000,100000,100000,100000,100000,100000,100000,1.52;...
% %                  100000,1,100000,100000,100000,100000,100000,100000,100000,1.51;...
% %                  100000,100000,1,100000,100000,100000,100000,100000,100000,0.0125;...
% %                  100000,100000,100000,1,100000,100000,100000,100000,100000,0.928;...
% %                  100000,100000,100000,100000,1,100000,100000,100000,100000,0.826;...
% %                  100000,100000,100000,100000,100000,1,100000,100000,100000,0.257;...
% %                  100000,100000,100000,100000,100000,100000,1,100000,100000,0.0187;...
% %                  100000,100000,100000,100000,100000,100000,100000,1,100000,0.00126;...
% %                  100000,100000,100000,100000,100000,100000,100000,100000,1,0.00928]; %um2/s Polymer Genome Based (unit activity)
% %     params.diffs = [1,100000,100000,100000,100000,100000,100000,100000,100000,0.0081;...
% %                  100000,1,100000,100000,100000,100000,100000,100000,100000,0.0146;...
% %                  100000,100000,1,100000,100000,100000,100000,100000,100000,0.000303;...
% %                  100000,100000,100000,1,100000,100000,100000,100000,100000,0.0346;...
% %                  100000,100000,100000,100000,1,100000,100000,100000,100000,0.00842;...
% %                  100000,100000,100000,100000,100000,1,100000,100000,100000,0.00243;...
% %                  100000,100000,100000,100000,100000,100000,1,100000,100000,0.000152;...
% %                  100000,100000,100000,100000,100000,100000,100000,1,100000,0.0000497;...
% %                  100000,100000,100000,100000,100000,100000,100000,100000,1,0.000741]; %um2/s Polymer Genome Based (zero activity)
% %     params.diffs = [1,100000,100000,100000,100000,100000,100000,100000,100000,1.52;...
% %                  100000,1,100000,100000,100000,100000,100000,100000,100000,1.51;...
% %                  100000,100000,1,100000,100000,100000,100000,100000,100000,0.00303;...
% %                  100000,100000,100000,1,100000,100000,100000,100000,100000,0.928;...
% %                  100000,100000,100000,100000,1,100000,100000,100000,100000,0.826;...
% %                  100000,100000,100000,100000,100000,1,100000,100000,100000,0.257;...
% %                  100000,100000,100000,100000,100000,100000,1,100000,100000,0.000152;...
% %                  100000,100000,100000,100000,100000,100000,100000,1,100000,0.000497;...
% %                  100000,100000,100000,100000,100000,100000,100000,100000,1,0.000741]; %um2/s Polymer Genome Based (unit mixed zero activity)
% 
%     %FICKS
% %     params.diffs = [1,1,1,1,1,1,1,1,1,6.87;...
% %                  1,1,1,1,1,1,1,1,1,10.3;...
% %                  1,1,1,1,1,1,1,1,1,.0113;...
% %                  1,1,1,1,1,1,1,1,1,3.35;...
% %                  1,1,1,1,1,1,1,1,1,3.34;...
% %                  1,1,1,1,1,1,1,1,1,2.71;...
% %                  1,1,1,1,1,1,1,1,1,10.1;...
% %                  1,1,1,1,1,1,1,1,1,0.00538;...
% %                  1,1,1,1,1,1,1,1,1,0.114;...
% %                  6.87,10.3,.0113,3.35,3.34,2.71,10.1,.00538,0.114,1]; %um2/s Ficks Ass Exp Based 
% %      params.diffs = [1,1,1,1,1,1,1,1,1,1.304;...
% %                  1,1,1,1,1,1,1,1,1,2.13;...
% %                  1,1,1,1,1,1,1,1,1,0.0051;...
% %                  1,1,1,1,1,1,1,1,1,0.0118;...
% %                  1,1,1,1,1,1,1,1,1,0.98;...
% %                  1,1,1,1,1,1,1,1,1,2.78;...
% %                  1,1,1,1,1,1,1,1,1,7.95;...
% %                  1,1,1,1,1,1,1,1,1,0.0035;...
% %                  1,1,1,1,1,1,1,1,1,0.389];
% %                  params.diffs(params.n+1,1:params.n+1) =  [params.diffs(:,end).',1]; %um2/s FICKS FH-BC tweaked for single comp
% %   params.diffs = [1,1,1,1,1,1,1,1,1,5;...
% %                  1,1,1,1,1,1,1,1,1,3.1;...
% %                  1,1,1,1,1,1,1,1,1,0.0123;...
% %                  1,1,1,1,1,1,1,1,1,0.725;...
% %                  1,1,1,1,1,1,1,1,1,1.78;...
% %                  1,1,1,1,1,1,1,1,1,5.1;...
% %                  1,1,1,1,1,1,1,1,1,3.4;...
% %                  1,1,1,1,1,1,1,1,1,0.0022;...
% %                  1,1,1,1,1,1,1,1,1,0.317];
% %                  params.diffs(params.n+1,1:params.n+1) =  [params.diffs(:,end).',1]; %um2/s FICKS FHLM-BC tweaked for single comp
% %   params.diffs = [1,1,1,1,1,1,1,1,1,22.3;...
% %                  1,1,1,1,1,1,1,1,1,4.52;...
% %                  1,1,1,1,1,1,1,1,1,0.032;...
% %                  1,1,1,1,1,1,1,1,1,0.725;...
% %                  1,1,1,1,1,1,1,1,1,2.16;...
% %                  1,1,1,1,1,1,1,1,1,6.25;...
% %                  1,1,1,1,1,1,1,1,1,0.47;...
% %                  1,1,1,1,1,1,1,1,1,0.006;...
% %                  1,1,1,1,1,1,1,1,1,0.33];
% %                  params.diffs(params.n+1,1:params.n+1) =  [params.diffs(:,end).',1]; %um2/s FICKS DSM-BC tweaked for single comp
%   
% %FH-LM params
%     params.Ch = [0.2;0.06475;0.207;0.00666;0.11;0.0099;0.01406;0.0144;0.00677];
%     params.bs = [0.694;0.263;610.749;1.543;0.381;0.158;1.924;87.449;249.039]; %torr^-1 mixed exp and genome
% 
%     
%     %DSM params
% %      params.Ch = [0.2;0.0782;0.0612;0;0.216;0.00949;0.0522;0.0133;0.00310];
% %      params.bs = [0.356;0.124;147;0.494;0.164;0.124;0.294;210;721]; %torr^-1 mixed exp and genome
%      params.ks = [0.00951;0.000658;5.96;0.0239;0.00514;0.00017;0.00725;0.337;0.972]; 
%     
% %  FFV Diff Model
%       params.unitActPhis = [0.394;0.0984;0.5214;0.0216;0.2415;0.0169;0.0387;0.0242;0.0160];
% %    params.Bffv = 0.5*[0;1;0;1;0;1;1;1;1]; %0 if phi_i_unit_act >~= FFV_dry and 0.3 if "" << "" 
% %     params.Bffv = 0.1*[1;1;1;1;1;1;1;1;1]; 
%      params.Bffv = [0;0;0;0.14;0;0.1005;0.245;0.225;0.116]; %fit to UAV and self Ds 
%      
% 
%     params.psat = [22;46.6;0.0799;0.951;14.8;49.1;2.504;0.0278;0.0131];%torr
%     params.lmem = .2; %um
%     params.yf = [0.171;0.281;0.0199;0.107;0.221;0.15;0.0217;0.0154;0.013];
%    % params.P_ = 88.8231; %atm = 90 bar
%    % params.Pu = 29.2154; %atm = 30 bar
%     params.Pu = 39.47; %atm = 40 bar
%     params.Pd = 1; %atm
%     params.T = 298; %K
%     params.R = 82.05; %atm cm^3/ mol K 

% GT amstetrCHEM MATLAB Unit-Op key: A7E23B7906F44B7D 
    

